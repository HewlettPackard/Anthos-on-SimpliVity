(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{464:function(e,s,t){"use strict";t.r(s);var a=t(45),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"deploying-service-mesh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploying-service-mesh"}},[e._v("#")]),e._v(" Deploying service mesh")]),e._v(" "),t("h2",{attrs:{id:"prerequsites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequsites"}},[e._v("#")]),e._v(" Prerequsites")]),e._v(" "),t("ul",[t("li",[e._v("Admin and user clusters deployed successfully")]),e._v(" "),t("li",[e._v("Configuration completed as described in the section "),t("a",{attrs:{href:"../config-core/service-mesh-config"}},[e._v("Service mesh configuration")])])]),e._v(" "),t("h2",{attrs:{id:"command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[e._v("#")]),e._v(" Command")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd ~/Anthos-on-SimpliVity\n\nansible-playbook playbooks/service_mesh.yml  --ask-vault-pass\n")])])]),t("h2",{attrs:{id:"tasks-performed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tasks-performed"}},[e._v("#")]),e._v(" Tasks performed")]),e._v(" "),t("ul",[t("li",[e._v("Downloads and unpacks Istio from <<istio_tar_file_url>>")]),e._v(" "),t("li",[e._v("For each user cluster that has "),t("code",[e._v("anthos_service_mesh_enable: true")]),e._v(" "),t("ul",[t("li",[e._v("Create Namespace "),t("code",[e._v("istio-system")])]),e._v(" "),t("li",[e._v("Copy required root cert into "),t("code",[e._v("istio-system")]),e._v(" namespace")]),e._v(" "),t("li",[e._v("Use "),t("code",[e._v("istioctl")]),e._v(" to deploy Service Mesh package")]),e._v(" "),t("li",[e._v("Wait for completion of service mesh deployment")]),e._v(" "),t("li",[e._v("Update the External IP for the LoadBalancer "),t("code",[e._v("anthos_service_mesh_externalIP")])]),e._v(" "),t("li",[e._v("Annotate namespaces to enable istio sidecar injection "),t("code",[e._v("anthos_service_mesh_sidecar_enable")])])])])]),e._v(" "),t("h2",{attrs:{id:"resources-deployed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#resources-deployed"}},[e._v("#")]),e._v(" Resources deployed")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n istio-system get deployment\n\nNAME                     READY   UP-TO-DATE   AVAILABLE   AGE\nistio-citadel            1/1     1            1           23h\nistio-galley             1/1     1            1           23h\nistio-ingressgateway     1/1     1            1           23h\nistio-pilot              1/1     1            1           23h\nistio-sidecar-injector   1/1     1            1           23h\npromsd                   1/1     1            1           23h\n \n\nkubectl -n istio-system get pods\n\nNAME                                      READY   STATUS    RESTARTS   AGE\nistio-citadel-64f6d7c7c7-vqqhb            1/1     Running   0          23h\nistio-galley-6b4878d445-784dn             2/2     Running   0          23h\nistio-ingressgateway-6f497c5df9-24ngz     2/2     Running   0          23h\nistio-pilot-7f4fdcb89c-7km97              2/2     Running   0          23h\nistio-sidecar-injector-65cbd565b9-9mh9x   1/1     Running   0          23h\npromsd-78dfdf7c7d-4dctv                   2/2     Running   1          23h\n\n\nkubectl -n istio-system get svc\n\nNAME                     TYPE           CLUSTER-IP       EXTERNAL-IP    PORT(S)                                                                                                                      AGE\nistio-citadel            ClusterIP      10.109.193.37    <none>         8060/TCP,15014/TCP                                                                                                           23h\nistio-galley             ClusterIP      10.110.158.217   <none>         443/TCP,15014/TCP,9901/TCP,15019/TCP                                                                                         23h\nistio-ingressgateway     LoadBalancer   10.110.50.233    10.15.158.55   15020:30970/TCP,80:32417/TCP,443:30921/TCP,15029:32551/TCP,15030:30335/TCP,15031:30934/TCP,15032:31978/TCP,15443:31414/TCP   23h\nistio-pilot              ClusterIP      10.111.151.231   <none>         15010/TCP,15011/TCP,8080/TCP,15014/TCP                                                                                       23h\nistio-sidecar-injector   ClusterIP      10.108.98.178    <none>         443/TCP                                                                                                                      23h\npromsd                   ClusterIP      10.104.44.116    <none>         9090/TCP                                                                                                                     23h\n\n")])])]),t("h2",{attrs:{id:"teardown"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#teardown"}},[e._v("#")]),e._v(" Teardown")]),e._v(" "),t("p",[e._v("To remove service mesh, delete the appropiate namespace:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl delete namespace istio-system\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);