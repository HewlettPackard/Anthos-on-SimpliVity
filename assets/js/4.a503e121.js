(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{407:function(e,s,a){e.exports=a.p+"assets/img/wordpress-lang.b709bd52.png"},408:function(e,s,a){e.exports=a.p+"assets/img/wordpress-install.afaba736.png"},409:function(e,s,a){e.exports=a.p+"assets/img/wordpress-welcome.e13768fc.png"},410:function(e,s,a){e.exports=a.p+"assets/img/wordpress-new-post.24cf956f.png"},411:function(e,s,a){e.exports=a.p+"assets/img/wordpress-new-post-done.2db6721f.png"},412:function(e,s,a){e.exports=a.p+"assets/img/wordpress-publish.26fd8afb.png"},429:function(e,s,a){"use strict";a.r(s);var t=a(35),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"deploying-wordpress-with-csi-storage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploying-wordpress-with-csi-storage"}},[e._v("#")]),e._v(" Deploying WordPress with CSI storage")]),e._v(" "),t("p",[e._v("WordPress uses a database to store posts and comments, while it stores other assets including images, CSS and\nJavascript files in a separate filestore. In this example, two persistent volume claims (PVCs) are deployed using\nthe HPE SimpliVity CSI Driver, one for the MySQL datadase and the other for the WordPress filestore.")]),e._v(" "),t("h2",{attrs:{id:"deploy-wordpress-with-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-wordpress-with-mysql"}},[e._v("#")]),e._v(" Deploy WordPress with MySQL")]),e._v(" "),t("p",[e._v("To deploy WordPress with MySQL on a user cluster, you will need to:")]),e._v(" "),t("ul",[t("li",[e._v("Connect to the admin workstation")]),e._v(" "),t("li",[e._v("Configure access to the user cluster")]),e._v(" "),t("li",[e._v("Use manifest files to deploy the required resources")])]),e._v(" "),t("h3",{attrs:{id:"connect-to-your-admin-workstation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-your-admin-workstation"}},[e._v("#")]),e._v(" Connect to your admin workstation")]),e._v(" "),t("p",[e._v("Connect to your admin workstation, using the appropriate IP address:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("ssh -i /root/anthos_secrets/vsphere_workstation ubuntu@10.15.155.200\n")])])]),t("h3",{attrs:{id:"configure-kubeconfig"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configure-kubeconfig"}},[e._v("#")]),e._v(" Configure KUBECONFIG")]),e._v(" "),t("p",[e._v("Configure KUBECONFIG, using the appropriate user cluster name, for example:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("export KUBECONFIG=~/kubeconfigs/gmcg-gke-usercluster-1-kubeconfig\n")])])]),t("h3",{attrs:{id:"create-namespace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-namespace"}},[e._v("#")]),e._v(" Create namespace")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("wordpress-mysql-namespace.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\nkind: Namespace\nmetadata:\n  name:  'wordpress-mysql'\n")])])]),t("p",[e._v("Create the namespace:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl apply -f wordpress-mysql-namespace.yml\n\nnamespace/wordpress-mysql created\n")])])]),t("h3",{attrs:{id:"create-secret-for-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-secret-for-mysql"}},[e._v("#")]),e._v(" Create secret for MySQL")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("mysql-password.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\ndata:\n  password: cGFzc3dvcmQ=\nkind: Secret\nmetadata:\n  name: mysql-pass\n  namespace: wordpress-mysql\n")])])]),t("p",[e._v("Create the secret:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  apply -f secret-password.yml\n\nsecret/mysql-pass created\n")])])]),t("h3",{attrs:{id:"create-pvc-for-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-pvc-for-mysql"}},[e._v("#")]),e._v(" Create PVC for MySQL")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("mysql-pvc.yml")]),e._v(" with the following content, updating the storage class with your CSI storage class for the user cluster:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: mysql-pv-claim\n  labels:\n    app: wordpress\n  annotations:\n    volume.beta.kubernetes.io/storage-class: 'gmcg-vmware-sc'\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 1Gi\n")])])]),t("p",[e._v("Create the PVC for MySQL:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql apply -f mysql-pvc.yml\n\npersistentvolumeclaim/mysql-pv-claim created\n")])])]),t("p",[e._v("Inspect the volume claim - it will initially be in the "),t("code",[e._v("pending")]),e._v(" state:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql get pvc\n\nNAME             STATUS    VOLUME   CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nmysql-pv-claim   Pending                                      gmcg-vmware-sc    10s\n")])])]),t("p",[e._v("Wait until the PVC has been created:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql get pvc\n\nNAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nmysql-pv-claim   Bound    pvc-ecc09402-75f3-477a-af75-15f87cd2c6a8   1Gi        RWO            gmcg-vmware-sc    53s\n")])])]),t("p",[e._v("Examine the corresponding PV:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql get pv\n\nNAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                        STORAGECLASS   REASON   AGE\n\npvc-ecc09402-75f3-477a-af75-15f87cd2c6a8   1Gi        RWO            Delete           Bound    wordpress-mysql/mysql-pv-claim               gmcg-vmware-sc             16s\n")])])]),t("h3",{attrs:{id:"create-service-for-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-service-for-mysql"}},[e._v("#")]),e._v(" Create service for MySQL")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("mysql-service.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\nkind: Service\nmetadata:\n  name: wordpress-mysql\n  labels:\n    app: wordpress\nspec:\n  ports:\n    - port: 3306\n  selector:\n    app: wordpress\n    tier: mysql\n  clusterIP: None\n")])])]),t("p",[e._v("Deploy the service:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  apply -f mysql-service.yml\n\nservice/wordpress-mysql created\n")])])]),t("p",[e._v("Inspect the service:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get svc wordpress-mysql\n\nNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE\nwordpress-mysql   ClusterIP   None         <none>        3306/TCP   17s\n")])])]),t("h3",{attrs:{id:"deploy-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-mysql"}},[e._v("#")]),e._v(" Deploy MySQL")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("mysql-deployment.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: wordpress-mysql\n  labels:\n    app: wordpress\nspec:\n  selector:\n    matchLabels:\n      app: wordpress\n      tier: mysql\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: wordpress\n        tier: mysql\n    spec:\n      containers:\n      - image: mysql:5.6\n        name: mysql\n        env:\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mysql-pass\n              key: password\n        ports:\n        - containerPort: 3306\n          name: mysql\n        volumeMounts:\n        - name: mysql-persistent-storage\n          mountPath: /var/lib/mysql\n      volumes:\n      - name: mysql-persistent-storage\n        persistentVolumeClaim:\n          claimName: mysql-pv-claim\n")])])]),t("p",[e._v("Deploy MySQL:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql apply -f mysql-deployment.yml\n\ndeployment.apps/wordpress-mysql created\n")])])]),t("p",[e._v("Inspect the deployment - it may take a while for it to complete:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get deployment wordpress-mysql\n\nNAME              READY   UP-TO-DATE   AVAILABLE   AGE\nwordpress-mysql   0/1     1            0           9s\n")])])]),t("p",[e._v("Wait until the deployment is ready:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get pods\n\nNAME                              READY   STATUS    RESTARTS   AGE\nwordpress-mysql-67565bd57-lvbg2   1/1     Running   0          64s\n")])])]),t("p",[e._v("You can get more information on the deployment using the "),t("code",[e._v("describe deployment")]),e._v(" option:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('kubectl -n wordpress-mysql describe deployment wordpress-mysql\n\nName:               wordpress-mysql\nNamespace:          wordpress-mysql\nCreationTimestamp:  Tue, 16 Jun 2020 13:27:39 +0000\nLabels:             app=wordpress\nAnnotations:        deployment.kubernetes.io/revision: 1\n                    kubectl.kubernetes.io/last-applied-configuration:\n                      {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app":"wordpress"},"name":"wordpress-mysql","namespace"...\nSelector:           app=wordpress,tier=mysql\nReplicas:           1 desired | 1 updated | 1 total | 1 available | 0 unavailable\nStrategyType:       Recreate\nMinReadySeconds:    0\nPod Template:\n  Labels:  app=wordpress\n           tier=mysql\n  Containers:\n   mysql:\n    Image:      mysql:5.6\n    Port:       3306/TCP\n    Host Port:  0/TCP\n    Environment:\n      MYSQL_ROOT_PASSWORD:  <set to the key \'password\' in secret \'mysql-pass\'>  Optional: false\n    Mounts:\n      /var/lib/mysql from mysql-persistent-storage (rw)\n  Volumes:\n   mysql-persistent-storage:\n    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)\n    ClaimName:  mysql-pv-claim\n    ReadOnly:   false\nConditions:\n  Type           Status  Reason\n  ----           ------  ------\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  <none>\nNewReplicaSet:   wordpress-mysql-67565bd57 (1/1 replicas created)\nEvents:\n  Type    Reason             Age   From                   Message\n  ----    ------             ----  ----                   -------\n  Normal  ScalingReplicaSet  53s   deployment-controller  Scaled up replica set wordpress-mysql-67565bd57 to 1\n')])])]),t("h3",{attrs:{id:"create-pvc-for-wordpress"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-pvc-for-wordpress"}},[e._v("#")]),e._v(" Create PVC for WordPress")]),e._v(" "),t("p",[e._v("Create the file "),t("code",[e._v("wordpress-pvc.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: wp-pv-claim\n  labels:\n    app: wordpress\n  annotations:\n    volume.beta.kubernetes.io/storage-class: 'gmcg-vmware-sc'\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 5Gi\n")])])]),t("p",[e._v("Create the PVC for WordPress:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql apply -f wordpress-pvc.yml\n\npersistentvolumeclaim/wp-pv-claim created\n")])])]),t("p",[e._v("Inspect the volume claim - it will initially be in the "),t("code",[e._v("pending")]),e._v(" state:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql get pvc wp-pv-claim\n \nNAME             STATUS    VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nwp-pv-claim      Pending                                                                        gmcg-vmware-sc    5s\n")])])]),t("p",[e._v("Wait until the PVC has been created:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get pvc wp-pv-claim\n\nNAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS      AGE\nwp-pv-claim      Bound    pvc-1363ba16-8215-442a-b094-35fdd46f535b   5Gi        RWO            gmcg-vmware-sc    9m23s\n")])])]),t("h3",{attrs:{id:"create-service-for-mysql-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-service-for-mysql-2"}},[e._v("#")]),e._v(" Create service for MySQL")]),e._v(" "),t("p",[e._v("Create a manifest named "),t("code",[e._v("wordpress-service.yml")]),e._v(" with content similar to the example below. The "),t("code",[e._v("loadBalancerIP")]),e._v(" in the example\nis an IP address on the network configured in F5 with "),t("code",[e._v("external_vlan_name")]),e._v(" set to "),t("code",[e._v("external")]),e._v(".\nThe IP address you choose must not already be in use and must be routable from the location of any client that sends requests to the Service.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: v1\nkind: Service\nmetadata:\n  name: wordpress\n  labels:\n    app: wordpress\nspec:\n  ports:\n    - port: 80\n  selector:\n    app: wordpress\n    tier: frontend\n  type: LoadBalancer\n  loadBalancerIP: 10.15.158.77\n")])])]),t("p",[e._v("Create the MySQL service:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql apply -f wordpress-service.yml\n\nservice/wordpress created\n")])])]),t("p",[e._v("Inspect the service:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get svc wordpress\n\nNAME        TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)        AGE\nwordpress   LoadBalancer   10.96.162.244   10.15.158.77   80:32064/TCP   5s\n")])])]),t("p",[e._v("In this scenario, a client will send a request to the "),t("code",[e._v("loadBalancerIP")]),e._v(" address 10.15.158.77 on TCP port 80.\nThe request gets routed to your F5 BIG-IP load balancer. The load balancer chooses one of your user cluster nodes,\nand forwards the request to the node address on TCP port 32064. The iptables rules on the node forward\nthe request to a member pod on TCP port 80. (By default, the "),t("code",[e._v("targetPort")]),e._v(" is set to the same value as the "),t("code",[e._v("port")]),e._v(" field).")]),e._v(" "),t("h3",{attrs:{id:"deploy-wordpress"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-wordpress"}},[e._v("#")]),e._v(" Deploy WordPress")]),e._v(" "),t("p",[e._v("Create a file named "),t("code",[e._v("wordpress-deployment.yml")]),e._v(" with the following content:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2\nkind: Deployment\nmetadata:\n  name: wordpress\n  labels:\n    app: wordpress\nspec:\n  selector:\n    matchLabels:\n      app: wordpress\n      tier: frontend\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: wordpress\n        tier: frontend\n    spec:\n      containers:\n      - image: wordpress:4.8-apache\n        name: wordpress\n        env:\n        - name: WORDPRESS_DB_HOST\n          value: wordpress-mysql\n        - name: WORDPRESS_DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mysql-pass\n              key: password\n        ports:\n        - containerPort: 80\n          name: wordpress\n        volumeMounts:\n        - name: wordpress-persistent-storage\n          mountPath: /var/www/html\n      volumes:\n      - name: wordpress-persistent-storage\n        persistentVolumeClaim:\n          claimName: wp-pv-claim\n")])])]),t("p",[e._v("Deploy WordPress:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql apply -f wordpress-deployment.yml\n\ndeployment.apps/wordpress created\n")])])]),t("p",[e._v("Inspect the deployment:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get deployment wordpress\n\nNAME              READY   UP-TO-DATE   AVAILABLE   AGE\nwordpress         0/1     1            0           8s\n")])])]),t("p",[e._v("Wait until WordPress is ready:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl -n wordpress-mysql  get deployment wordpress\n\nNAME        READY   UP-TO-DATE   AVAILABLE   AGE\nwordpress   1/1     1            1           34s\n")])])]),t("p",[e._v("You can use the "),t("code",[e._v("describe deployment")]),e._v(" option to obtain more information about the deployment:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('kubectl -n wordpress-mysql  describe deployment wordpress\nName:               wordpress\nNamespace:          wordpress-mysql\nCreationTimestamp:  Tue, 16 Jun 2020 13:59:18 +0000\nLabels:             app=wordpress\nAnnotations:        deployment.kubernetes.io/revision: 1\n                    kubectl.kubernetes.io/last-applied-configuration:\n                      {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app":"wordpress"},"name":"wordpress","namespace":"word...\nSelector:           app=wordpress,tier=frontend\nReplicas:           1 desired | 1 updated | 1 total | 1 available | 0 unavailable\nStrategyType:       Recreate\nMinReadySeconds:    0\nPod Template:\n  Labels:  app=wordpress\n           tier=frontend\n  Containers:\n   wordpress:\n    Image:      wordpress:4.8-apache\n    Port:       80/TCP\n    Host Port:  0/TCP\n    Environment:\n      WORDPRESS_DB_HOST:      wordpress-mysql\n      WORDPRESS_DB_PASSWORD:  <set to the key \'password\' in secret \'mysql-pass\'>  Optional: false\n    Mounts:\n      /var/www/html from wordpress-persistent-storage (rw)\n  Volumes:\n   wordpress-persistent-storage:\n    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)\n    ClaimName:  wp-pv-claim\n    ReadOnly:   false\nConditions:\n  Type           Status  Reason\n  ----           ------  ------\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  <none>\nNewReplicaSet:   wordpress-549c4f6867 (1/1 replicas created)\nEvents:\n  Type    Reason             Age   From                   Message\n  ----    ------             ----  ----                   -------\n  Normal  ScalingReplicaSet  30s   deployment-controller  Scaled up replica set wordpress-549c4f6867 to 1\n')])])]),t("h2",{attrs:{id:"accessing-the-wordpress-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#accessing-the-wordpress-service"}},[e._v("#")]),e._v(" Accessing the WordPress service")]),e._v(" "),t("p",[e._v("You can browse to the LoadBalancerIP, in this case 10.15.158.77 and choose your language:")]),e._v(" "),t("p",[t("img",{attrs:{src:a(407),alt:'"WordPress install"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress language")]),e._v(" "),t("p",[e._v("Fill in the details and install:")]),e._v(" "),t("p",[t("img",{attrs:{src:a(408),alt:'"WordPress install"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress install")]),e._v(" "),t("p",[e._v("When you log in to WordPress, you will see the admin dashboard:")]),e._v(" "),t("p",[t("img",{attrs:{src:a(409),alt:'"WordPress admin dashboard"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress admin dashboard")]),e._v(" "),t("p",[e._v('Create a new blog post by clicking "Write your first blog post":')]),e._v(" "),t("p",[t("img",{attrs:{src:a(410),alt:'"WordPress new post"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress new post")]),e._v(" "),t("p",[e._v('Add a title and some text content, and then insert an image into your blog post by clicking on "Add Media":')]),e._v(" "),t("p",[t("img",{attrs:{src:a(411),alt:'"WordPress finished new post"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress finished new post")]),e._v(" "),t("p",[e._v("Click the "),t("code",[e._v("Publish")]),e._v(" button to make the blog post public and then view the post:")]),e._v(" "),t("p",[t("img",{attrs:{src:a(412),alt:'"WordPress published post"'}})]),e._v(" "),t("p",[t("strong",[e._v("Figure ?.")]),e._v(" WordPress published post")]),e._v(" "),t("h2",{attrs:{id:"exploring-wordpress-content"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#exploring-wordpress-content"}},[e._v("#")]),e._v(" Exploring WordPress content")]),e._v(" "),t("p",[e._v("Identify the WordPress pod, in this case, "),t("code",[e._v("wordpress-549c4f6867-7qx66")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl get pods -n wordpress-mysql\n\nNAME                              READY   STATUS    RESTARTS   AGE\nwordpress-549c4f6867-7qx66        1/1     Running   0          19h\nwordpress-mysql-67565bd57-lvbg2   1/1     Running   0          19h\n")])])]),t("p",[e._v("Install "),t("code",[e._v("jq")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo apt-get install jq\n")])])]),t("p",[e._v("Use a json query to identify the volume mounts:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('kubectl get pods -n wordpress-mysql wordpress-549c4f6867-7qx66 -o json | jq \'.spec.containers[].volumeMounts\'\n\n[\n  {\n    "mountPath": "/var/www/html",\n    "name": "wordpress-persistent-storage"\n  },\n  {\n    "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount",\n    "name": "default-token-2wqzq",\n    "readOnly": true\n  }\n]\n')])])]),t("p",[e._v("Use a json query to match the volume mount with the corresponding PVC name:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('kubectl get pods -n wordpress-mysql wordpress-549c4f6867-7qx66 -o json | jq \'.spec.volumes\'\n\n[\n  {\n    "name": "wordpress-persistent-storage",\n    "persistentVolumeClaim": {\n      "claimName": "wp-pv-claim"\n    }\n  },\n  {\n    "name": "default-token-2wqzq",\n    "secret": {\n      "defaultMode": 420,\n      "secretName": "default-token-2wqzq"\n    }\n  }\n]\n')])])]),t("p",[e._v("You will see that the PVC "),t("code",[e._v("wp-pv-claim")]),e._v(" is mounted at "),t("code",[e._v("/var/www/html")]),e._v(". You can execute a command on the pod to list\nthe files:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl exec --stdin --tty -n wordpress-mysql wordpress-549c4f6867-7qx66 -- /bin/ls -l /var/www/html\n\n-rw-r--r--  1 www-data www-data   418 Sep 25  2013 index.php\n-rw-r--r--  1 www-data www-data 19935 Jun 16 15:50 license.txt\n...\ndrwxr-xr-x  6 www-data www-data  4096 Jun 16 16:01 wp-content\n...\n")])])]),t("p",[e._v("If you navigate through the "),t("code",[e._v("wp-content")]),e._v(" folder, you will find the files corresponding to the image you added to\nthe blog post:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl exec --stdin --tty -n wordpress-mysql wordpress-549c4f6867-7qx66 -- /bin/ls -l /var/www/html/wp-content/uploads/2020/06\n\ntotal 124\n-rw-r--r-- 1 www-data www-data  3290 Jun 16 16:01 380-with-OmniStack-100x100.jpg\n-rw-r--r-- 1 www-data www-data  6183 Jun 16 16:01 380-with-OmniStack-150x150.jpg\n-rw-r--r-- 1 www-data www-data  8928 Jun 16 16:01 380-with-OmniStack-300x150.jpg\n-rw-r--r-- 1 www-data www-data 36764 Jun 16 16:01 380-with-OmniStack-768x384.jpg\n-rw-r--r-- 1 www-data www-data 65386 Jun 16 16:01 380-with-OmniStack.jpg\n")])])]),t("p",[e._v("Notice how there are multiple versions of the image, to cater for devices with different resolutions or for thumbnails.")]),e._v(" "),t("p",[e._v("You can also copy the WordPress content to your local machine using the "),t("code",[e._v("kubectl cp")]),e._v(" command:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl cp -n wordpress-mysql wordpress-549c4f6867-7qx66:/var/www/html  wordpress-backup-20200617\n")])])]),t("p",[e._v("Once again, you can navigate down to the files corresponding to the image:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("ls -l wordpress-backup-20200617/wp-content/uploads/2020/06\n\ntotal 124\n-rw-rw-r-- 1 ubuntu ubuntu  3290 Jun 17 09:44 380-with-OmniStack-100x100.jpg\n-rw-rw-r-- 1 ubuntu ubuntu  6183 Jun 17 09:44 380-with-OmniStack-150x150.jpg\n-rw-rw-r-- 1 ubuntu ubuntu  8928 Jun 17 09:44 380-with-OmniStack-300x150.jpg\n-rw-rw-r-- 1 ubuntu ubuntu 36764 Jun 17 09:44 380-with-OmniStack-768x384.jpg\n-rw-rw-r-- 1 ubuntu ubuntu 65386 Jun 17 09:44 380-with-OmniStack.jpg\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);